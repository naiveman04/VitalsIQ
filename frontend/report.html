<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Upload Report - Vitals IQ</title>

    <!-- CSS and Library Imports -->
    <link
        rel="stylesheet"
        href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
    />
    <link
        rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
    />
    <link
        rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
    />
    <link
        rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css"
    />
    <link rel="stylesheet" href="Styling/landing.css" />
    <link rel="stylesheet" href="Styling/report.css" />

</head>
<body>
    <!-- Page Loader -->
    <div class="page-loader">
        <div class="loader"></div>
    </div>

    <!-- Scroll to Top Button -->
    <div class="scroll-to-top">
        <i class="fa fa-angle-up"></i>
    </div>

    <!-- Header Section Start -->
    <div class="header_section">
        <div class="container-fluid d-flex justify-content-between align-items-center">
            <div class="logo">
                <a href="landing.html"><img src="images/Logo2.png" alt="Logo" /></a>
            </div>

            <!-- About Us button -->
            <div class="d-none d-md-block">
                <a href="report.html" class="analyze-btn">Analyze</a>
                <a href="about.html" class="about-us-btn">About Us</a>
            </div>

            <!-- Mobile Menu Icon -->
            <span class="d-md-none" onclick="openNav()">
                <i class="fa fa-bars fa-lg" style="color: #5e17eb"></i>
            </span>
        </div>
        <!-- Overlay Navigation for Mobile -->
        <div id="myNav" class="overlay">
            <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">×</a>
            <div class="overlay-content">
                <a href="landing.html">Home</a>
                <a href="about.html">About</a>
                <a href="#">Services</a>
                <a href="#">Contact</a>
            </div>
        </div>
    </div>
    <!-- Header Section End -->

    <!-- Upload Section Start -->
    <div class="upload-section">
        <div class="glow-accent pulse-animation" style="top: 30%; left: 5%"></div>
        <div class="glow-accent pulse-animation" style="bottom: 30%; right: 5%"></div>

        <div class="container">
            <div class="row">
                <div class="col-12" data-aos="fade-up" data-aos-duration="1000">
                    <h2 class="section-title">Upload Your Health Report PDF</h2>
                    <p class="section-description">
                        Easily upload your health report in PDF format to get a detailed analysis. Simply drag and drop your file into the box below or click to select a file from your device. Once uploaded, click "Upload & Analyze" to view your health insights on the next page.
                    </p>
                    <div class="upload-container">
                      <h3>Upload Your PDF</h3>
                      <form id="uploadForm" onsubmit="return false;">
                          <div class="upload-box">
                              <i class="fas fa-upload"></i>
                              <p id="uploadText">Drag & Drop your PDF here or click to upload</p>
                              <input type="file" id="reportInput" accept="application/pdf" />
                              <label for="reportInput">Choose File</label>
                          </div>
                          <button type="button" id="analyzeBtn" class="analyze-report-btn" disabled>Upload & Analyze</button>
                      </form>
                  </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Upload Section End -->

    <!-- Manual Entry Section Start -->
    <div class="manual-entry-section">
        <div class="glow-accent pulse-animation" style="top: 20%; left: 10%"></div>
        <div class="glow-accent pulse-animation" style="bottom: 20%; right: 10%"></div>

        <div class="container">
            <div class="row">
                <div class="col-12" data-aos="fade-up" data-aos-duration="1000">
                    <h2 class="section-title">Enter Your Health Parameters Manually</h2>
                    <p class="section-description">
                        If you don't have a PDF report, you can manually enter your health parameters below. Fill in the fields with your latest health metrics (e.g., blood pressure, glucose levels). Once you've entered your data, click "Analyze Manual Entry" to see your health analysis on the next page.
                    </p>
                    <div class="manual-entry-container">
                        <h3>Manual Entry Form</h3>
                        <form id="manualEntryForm">
                            <div class="form-row">
                                <!-- First Column -->
                                <div class="form-column">
                                    <div class="form-group">
                                        <label for="bloodPressure">Blood Pressure (mmHg):</label>
                                        <input type="text" id="bloodPressure" name="bloodPressure" placeholder="e.g., 120/80" />
                                    </div>
                                    <div class="form-group">
                                        <label for="glucose">Blood Glucose (mg/dL):</label>
                                        <input type="text" id="glucose" name="glucose" placeholder="e.g., 90" />
                                    </div>
                                    <div class="form-group">
                                        <label for="hemoglobin">Hemoglobin (g/dL):</label>
                                        <input type="text" id="hemoglobin" name="hemoglobin" placeholder="e.g., 13.5" />
                                    </div>
                                    <div class="form-group">
                                        <label for="cholesterol">Total Cholesterol (mg/dL):</label>
                                        <input type="text" id="cholesterol" name="cholesterol" placeholder="e.g., 180" />
                                    </div>
                                </div>
                                <!-- Second Column -->
                                <div class="form-column">
                                    <div class="form-group">
                                        <label for="hdl">HDL Cholesterol (mg/dL):</label>
                                        <input type="text" id="hdl" name="hdl" placeholder="e.g., 50" />
                                    </div>
                                    <div class="form-group">
                                        <label for="ldl">LDL Cholesterol (mg/dL):</label>
                                        <input type="text" id="ldl" name="ldl" placeholder="e.g., 100" />
                                    </div>
                                    <div class="form-group">
                                        <label for="wbc">White Blood Cell Count (cells/µL):</label>
                                        <input type="text" id="wbc" name="wbc" placeholder="e.g., 7000" />
                                    </div>
                                    <div class="form-group">
                                        <label for="platelets">Platelets (cells/µL):</label>
                                        <input type="text" id="platelets" name="platelets" placeholder="e.g., 250000" />
                                    </div>
                                </div>
                            </div>
                            <div class="button-container">
                                <button type="button" id="manualAnalyzeBtn" class="analyze-report-btn">Analyze Manual Entry</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Manual Entry Section End -->

    <!-- Additional Text Section Start -->
    <div class="additional-text-section">
        <div class="container">
            <div class="row">
                <div class="col-12" data-aos="fade-up" data-aos-duration="1000">
                    <br>
                    <p class="report-text">
                        Welcome to the Health Report Analysis tool by Vitals IQ. This powerful tool helps you understand
                        your medical reports in simple language, identify potential health concerns, and get
                        personalized recommendations.
                    </p>

                    <div class="highlight-box">
                        <p>"Your health data tells a story. We help you understand that story and make informed
                          decisions for a healthier future."</p>
                    </div>

                    <h3 class="section-subtitle">How It Works</h3>
                    <p class="report-text">
                        Our advanced algorithms analyze your health reports and translate complex medical terminology
                        into clear, actionable insights. By understanding the patterns and correlations in your data, we
                        can help you identify potential health issues before they become serious problems.
                    </p>
                    <p class="report-text">
                        Simply upload your health report or manually enter your health parameters below, and our system
                        will generate a comprehensive analysis with personalized recommendations tailored to your unique
                        health profile.
                    </p>
          
                </div>
            </div>
        </div>
    </div>
    <!-- Additional Text Section End -->

    <!-- Footer Section Start -->
    <div class="footer_section">
        <div class="container">
            <div class="row">
                <div class="col-lg-3 col-sm-6" data-aos="fade-up" data-aos-delay="100">
                    <h2 class="useful_text">Resources</h2>
                    <ul>
                        <li>
                            <a href="#" class="resource-link">
                                What we do
                                <div class="resource-popup">
                                    <span class="popup-text">
                                        We provide comprehensive health analysis and recommendations based on your medical reports to help you take control of your well-being.
                                    </span>
                                </div>
                            </a>
                        </li>
                        <li>
                            <a href="#" class="resource-link">
                                Media
                                <div class="resource-popup">
                                    <span class="popup-text">
                                        Browse our collection of health articles, videos, and infographics designed to educate and empower you on your health journey.
                                    </span>
                                </div>
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="col-lg-3 col-sm-6" data-aos="fade-up" data-aos-delay="200">
                    <h2 class="useful_text">About</h2>
                    <p class="footer_text">
                        Discover our mission to enhance your health and quality of life with timely checkups and expert advice.
                    </p>
                </div>
                <div class="col-lg-3 col-sm-6" data-aos="fade-up" data-aos-delay="300">
                    <h2 class="useful_text">Contact Us</h2>
                    <ul class="location_text">
                        <li>
                            <i class="fa fa-map-marker" aria-hidden="true"></i> Pune, Maharashtra
                        </li>
                        <li>
                            <i class="fa fa-phone" aria-hidden="true"></i> +91 9502772952
                        </li>
                        <li>
                            <i class="fa fa-envelope" aria-hidden="true"></i>
                            <a href="mailto:vedantnarawadkar@gmail.com">vedantnarawadkar@gmail.com</a>
                        </li>
                    </ul>
                </div>
                <div class="col-lg-3 col-sm-6" data-aos="fade-up" data-aos-delay="400">
                    <h2 class="useful_text">Countries</h2>
                    <img src="images/map.png" alt="Map" class="img-fluid" />
                </div>
            </div>
        </div>
    </div>
    <!-- Footer Section End -->

    <!-- Copyright Section Start -->
    <div class="copyright_section">
        <div class="container">
            <p>© 2025 All Rights Reserved.</p>
        </div>
    </div>
    <!-- Copyright Section End -->

    <!-- Javascript Files -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
    <!-- <script src="Functionality/report.js"></script> -->

    <!-- Inline JavaScript -->
    <script>
// Initialize AOS animations
AOS.init();

// Page loader
$(window).on("load", function () {
    setTimeout(function () {
        $(".page-loader").addClass("fade-out");
    }, 1000);
});

// Toggle overlay navigation
function openNav() {
    document.getElementById("myNav").style.width = "100%";
    setTimeout(function () {
        document.getElementById("myNav").classList.add("open");
    }, 100);
}

function closeNav() {
    document.getElementById("myNav").classList.remove("open");
    setTimeout(function () {
        document.getElementById("myNav").style.width = "0%";
    }, 300);
}

// Sticky header
$(window).scroll(function () {
    if ($(this).scrollTop() > 50) {
        $(".header_section").addClass("scrolled");
        $(".scroll-to-top").addClass("active");
    } else {
        $(".header_section").removeClass("scrolled");
        $(".scroll-to-top").removeClass("active");
    }
});

// Scroll to top functionality
$(".scroll-to-top").click(function () {
    $("html, body").animate({ scrollTop: 0 }, 800);
    return false;
});
// File upload handling

// Manual entry handling
const healthEntryForm = document.getElementById("manualEntryForm");
const submitHealthDataBtn = document.getElementById("manualAnalyzeBtn");

// Prevent default form submission
healthEntryForm.addEventListener('submit', (e) => e.preventDefault());

// Single click handler for analyze button
submitHealthDataBtn.addEventListener("click", async function(e) {
    e.preventDefault(); // Prevent any default action
    
    // Disable button to prevent multiple clicks
    submitHealthDataBtn.disabled = true;
    
    try {
        // Collect form data
        const formData = new FormData(healthEntryForm);
        const healthParameters = {};

        // Map form inputs to an object
        formData.forEach((value, key) => {
            if (value.trim() !== "") {
                healthParameters[key] = value.trim();
            }
        });

        // Validate that at least one field is filled
        if (Object.keys(healthParameters).length === 0) {
            alert("Please enter at least one health parameter to analyze.");
            submitHealthDataBtn.disabled = false;
            return;
        }

        // Store the manual entry data in localStorage
        localStorage.setItem("manualHealthData", JSON.stringify(healthParameters));

        // Send single request to backend
        const response = await fetch("http://localhost:5000/analyze_health_data", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify(healthParameters),
        });

        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }

        const result = await response.json();

        if (!result.success) {
            throw new Error(result.error || "Failed to analyze health data");
        }

        // Store the analysis result and redirect
        localStorage.setItem("analysisResult", JSON.stringify(result));
        localStorage.setItem("inputType", "manual");
        
        // Use window.location.replace for more reliable redirect
        window.location.replace("result.html");

    } catch (error) {
        console.error("Error submitting health parameters:", error);
        alert("An error occurred while analyzing your data. Please try again.");
    } finally {
        // Re-enable button in case of error
        submitHealthDataBtn.disabled = false;
    }
});
</script>
<script src="Functionality/upload.js"></script>
</body>
</html>